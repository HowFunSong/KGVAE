PID: 21624
Experiment Description: 
########## Model HPs ##########
tau: 0.2
cl_weight: 0.1
mu: 0.7
########## Model Parameters ##########
learning rate: 0.0010
context_hops: 2
node_dropout: 1
node_dropout_rate: 0.5
mess_dropout: 1
mess_dropout_rate: 0.1
all_embed: torch.Size([42296, 64])
interact_mat: torch.Size([2625, 2625])
edge_index: torch.Size([2, 332742])
edge_type: torch.Size([332742])
Pretraining RecVAE for 50 epochs (enc 3 / dec 1)...
RecVAE 預訓練完成，已更新 KGCL 的 user embeddings。
Starting KGCL training...
Negative sampling time: 0.47s
train_cf_triples shape: (65641, 3)
Epoch 0000 | CF Time: 23.5s | KG Time: 13.3s | Mean KG Loss: 0.6880

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   0   |   23.5  |   13.3  | [0.15468181] | [0.27357977] | [0.21930011] | [0.80593849] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 0
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0001 | CF Time: 23.1s | KG Time: 12.6s | Mean KG Loss: 0.6826

+-------+---------+---------+--------------+--------------+--------------+-------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio  |
+-------+---------+---------+--------------+--------------+--------------+-------------+
|   1   |   23.1  |   12.6  | [0.18125198] | [0.30009626] | [0.25111347] | [0.8504772] |
+-------+---------+---------+--------------+--------------+--------------+-------------+
### Found better model at epoch 1
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0002 | CF Time: 23.1s | KG Time: 12.7s | Mean KG Loss: 0.6778

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   2   |   23.1  |   12.7  | [0.18548348] | [0.31230918] | [0.25577943] | [0.85790032] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 2
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0003 | CF Time: 23.2s | KG Time: 13.1s | Mean KG Loss: 0.6723

+-------+---------+---------+--------------+--------------+-------------+------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  | Hit Ratio  |
+-------+---------+---------+--------------+--------------+-------------+------------+
|   3   |   23.2  |   13.1  | [0.19397975] | [0.31968056] | [0.2659597] | [0.873807] |
+-------+---------+---------+--------------+--------------+-------------+------------+
### Found better model at epoch 3
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0004 | CF Time: 23.5s | KG Time: 12.9s | Mean KG Loss: 0.6667

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   4   |   23.5  |   12.9  | [0.20103358] | [0.3393606] | [0.27826087] | [0.87910923] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 4
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0005 | CF Time: 23.2s | KG Time: 13.3s | Mean KG Loss: 0.6604

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   5   |   23.2  |   13.3  | [0.20111411] | [0.33903984] | [0.28144221] | [0.87804878] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 5
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0006 | CF Time: 23.1s | KG Time: 13.2s | Mean KG Loss: 0.6538

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   6   |   23.1  |   13.2  | [0.19970569] | [0.33792734] | [0.28059385] | [0.88016967] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0007 | CF Time: 23.1s | KG Time: 13.0s | Mean KG Loss: 0.6467

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   7   |   23.1  |   13.0  | [0.20789393] | [0.34220592] | [0.28229056] | [0.89395546] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 7
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
