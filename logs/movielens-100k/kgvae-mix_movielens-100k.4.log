PID: 1900
Experiment Description: 
########## Model HPs ##########
tau: 0.2
cl_weight: 0.1
mu: 0.7
########## Model Parameters ##########
learning rate: 0.0010
context_hops: 2
node_dropout: 1
node_dropout_rate: 0.5
mess_dropout: 1
mess_dropout_rate: 0.1
all_embed: torch.Size([42296, 64])
interact_mat: torch.Size([2625, 2625])
edge_index: torch.Size([2, 332742])
edge_type: torch.Size([332742])
Pretraining RecVAE for 50 epochs (enc 3 / dec 1)...
RecVAE 預訓練完成，已更新 KGCL 的 user embeddings。
Starting KGCL training...
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0000 | CF Time: 22.8s | KG Time: 12.9s | Mean KG Loss: 0.6880

+-------+---------+---------+------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |   Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+------------+--------------+--------------+--------------+
|   0   |   22.8  |   12.9  | [0.150932] | [0.26096334] | [0.21558855] | [0.79745493] |
+-------+---------+---------+------------+--------------+--------------+--------------+
### Found better model at epoch 0
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0001 | CF Time: 23.5s | KG Time: 12.5s | Mean KG Loss: 0.6826

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   1   |   23.5  |   12.5  | [0.17912129] | [0.30640005] | [0.24782609] | [0.85153765] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 1
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0002 | CF Time: 24.0s | KG Time: 12.5s | Mean KG Loss: 0.6778

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   2   |   24.0  |   12.5  | [0.19603901] | [0.32883905] | [0.26892895] | [0.86638388] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 2
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0003 | CF Time: 24.0s | KG Time: 12.3s | Mean KG Loss: 0.6723

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   3   |   24.0  |   12.3  | [0.19544347] | [0.33141596] | [0.27306469] | [0.86638388] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0004 | CF Time: 23.1s | KG Time: 12.7s | Mean KG Loss: 0.6667

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   4   |   23.1  |   12.7  | [0.20330586] | [0.34479252] | [0.28335101] | [0.88335101] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 4
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0005 | CF Time: 23.8s | KG Time: 12.7s | Mean KG Loss: 0.6604

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   5   |   23.8  |   12.7  | [0.20565864] | [0.34458493] | [0.28324496] | [0.89183457] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 5
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0006 | CF Time: 23.0s | KG Time: 12.6s | Mean KG Loss: 0.6538

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   6   |   23.0  |   12.6  | [0.21194585] | [0.35090437] | [0.2921527] | [0.89607635] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
### Found better model at epoch 6
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0007 | CF Time: 23.2s | KG Time: 12.5s | Mean KG Loss: 0.6467

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   7   |   23.2  |   12.5  | [0.20723046] | [0.34461453] | [0.28441145] | [0.89077413] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0008 | CF Time: 23.3s | KG Time: 12.1s | Mean KG Loss: 0.6387

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   8   |   23.3  |   12.1  | [0.21287835] | [0.3504966] | [0.29034995] | [0.88971368] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 8
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0009 | CF Time: 24.3s | KG Time: 12.3s | Mean KG Loss: 0.6299

+-------+---------+---------+--------------+--------------+--------------+-------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio  |
+-------+---------+---------+--------------+--------------+--------------+-------------+
|   9   |   24.3  |   12.3  | [0.21227189] | [0.35294837] | [0.29013786] | [0.8971368] |
+-------+---------+---------+--------------+--------------+--------------+-------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0010 | CF Time: 24.4s | KG Time: 13.1s | Mean KG Loss: 0.6198

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   10  |   24.4  |   13.1  | [0.21500534] | [0.35651007] | [0.29374337] | [0.89819724] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 10
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0011 | CF Time: 23.1s | KG Time: 12.8s | Mean KG Loss: 0.6083

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   11  |   23.1  |   12.8  | [0.21752504] | [0.35849425] | [0.29734889] | [0.89395546] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 11
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0012 | CF Time: 23.0s | KG Time: 12.6s | Mean KG Loss: 0.5951

+-------+---------+---------+--------------+--------------+------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     | Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+------------+--------------+
|   12  |   23.0  |   12.6  | [0.21853393] | [0.35878959] | [0.295228] | [0.90137858] |
+-------+---------+---------+--------------+--------------+------------+--------------+
### Found better model at epoch 12
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0013 | CF Time: 22.9s | KG Time: 12.4s | Mean KG Loss: 0.5802

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   13  |   22.9  |   12.4  | [0.21392909] | [0.35542412] | [0.29278897] | [0.89501591] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0014 | CF Time: 23.4s | KG Time: 12.2s | Mean KG Loss: 0.5644

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   14  |   23.4  |   12.2  | [0.21383902] | [0.35214787] | [0.29151644] | [0.89395546] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0015 | CF Time: 23.3s | KG Time: 12.6s | Mean KG Loss: 0.5461

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   15  |   23.3  |   12.6  | [0.21397681] | [0.35459709] | [0.29289502] | [0.90243902] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.38s
train_cf_triples shape: (65641, 3)
Epoch 0016 | CF Time: 23.3s | KG Time: 12.4s | Mean KG Loss: 0.5285

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   16  |   23.3  |   12.4  | [0.20584544] | [0.34684829] | [0.28695652] | [0.88335101] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0017 | CF Time: 23.4s | KG Time: 13.0s | Mean KG Loss: 0.5108

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   17  |   23.4  |   13.0  | [0.20869675] | [0.35127727] | [0.28950159] | [0.88335101] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Early stopping triggered at epoch 17
Training complete. Early stopping at epoch 17, recall@20: 0.2185
