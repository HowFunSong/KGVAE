PID: 13260
Experiment Description: 
########## Model HPs ##########
tau: 0.2
cl_weight: 0.1
mu: 0.7
########## Model Parameters ##########
learning rate: 0.0010
context_hops: 2
node_dropout: 1
node_dropout_rate: 0.5
mess_dropout: 1
mess_dropout_rate: 0.1
all_embed: torch.Size([42296, 64])
interact_mat: torch.Size([2625, 2625])
edge_index: torch.Size([2, 332742])
edge_type: torch.Size([332742])
Pretraining RecVAE for 50 epochs (enc 3 / dec 1)...
RecVAE pretraining complete. Final encoder loss=972.9319, decoder loss=971.6530
Pretraining of RecVAE complete; KGCL user embeddings have been updated.
Starting KGCL training...
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0000 | CF Time: 22.7s | KG Time: 12.5s | Mean KG Loss: 0.6880

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   0   |   22.7  |   12.5  | [0.15137899] | [0.2592547] | [0.21505832] | [0.80699894] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 0
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0001 | CF Time: 23.3s | KG Time: 12.6s | Mean KG Loss: 0.6826

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   1   |   23.3  |   12.6  | [0.16969385] | [0.28235625] | [0.23372216] | [0.84835631] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 1
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0002 | CF Time: 23.3s | KG Time: 14.5s | Mean KG Loss: 0.6778

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   2   |   23.3  |   14.5  | [0.18450927] | [0.30494389] | [0.2552492] | [0.86426299] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
### Found better model at epoch 2
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0003 | CF Time: 23.3s | KG Time: 12.6s | Mean KG Loss: 0.6723

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   3   |   23.3  |   12.6  | [0.19780846] | [0.32720243] | [0.27115589] | [0.88123012] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 3
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0004 | CF Time: 23.8s | KG Time: 12.6s | Mean KG Loss: 0.6667

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   4   |   23.8  |   12.6  | [0.20632304] | [0.34077979] | [0.28059385] | [0.88229056] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 4
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0005 | CF Time: 23.0s | KG Time: 12.7s | Mean KG Loss: 0.6604

+-------+---------+---------+-------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+-------------+--------------+--------------+--------------+
|   5   |   23.0  |   12.7  | [0.2099286] | [0.35074975] | [0.28632025] | [0.89395546] |
+-------+---------+---------+-------------+--------------+--------------+--------------+
### Found better model at epoch 5
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0006 | CF Time: 23.0s | KG Time: 12.6s | Mean KG Loss: 0.6538

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   6   |   23.0  |   12.6  | [0.21485148] | [0.36115755] | [0.29300106] | [0.89925769] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 6
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0007 | CF Time: 23.6s | KG Time: 12.9s | Mean KG Loss: 0.6467

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   7   |   23.6  |   12.9  | [0.21475435] | [0.36250423] | [0.29448568] | [0.89607635] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.37s
train_cf_triples shape: (65641, 3)
Epoch 0008 | CF Time: 23.5s | KG Time: 12.8s | Mean KG Loss: 0.6388

+-------+---------+---------+--------------+--------------+------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     | Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+------------+--------------+
|   8   |   23.5  |   12.8  | [0.21633956] | [0.36425668] | [0.295228] | [0.89289502] |
+-------+---------+---------+--------------+--------------+------------+--------------+
### Found better model at epoch 8
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0009 | CF Time: 24.7s | KG Time: 12.9s | Mean KG Loss: 0.6301

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   9   |   24.7  |   12.9  | [0.21721322] | [0.3645099] | [0.29639449] | [0.89925769] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 9
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0010 | CF Time: 24.1s | KG Time: 12.6s | Mean KG Loss: 0.6200

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   10  |   24.1  |   12.6  | [0.21884482] | [0.36773341] | [0.29957582] | [0.89819724] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 10
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0011 | CF Time: 24.1s | KG Time: 15.2s | Mean KG Loss: 0.6085

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   11  |   24.1  |   15.2  | [0.22084249] | [0.37211209] | [0.30148462] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 11
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0012 | CF Time: 24.3s | KG Time: 12.3s | Mean KG Loss: 0.5954

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   12  |   24.3  |   12.3  | [0.22198401] | [0.37240768] | [0.30021209] | [0.90243902] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 12
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0013 | CF Time: 24.5s | KG Time: 12.8s | Mean KG Loss: 0.5806

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   13  |   24.5  |   12.8  | [0.22179454] | [0.37338004] | [0.30222694] | [0.90031813] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
