PID: 9032
Experiment Description: 
########## Model HPs ##########
tau: 0.2
cl_weight: 0.1
mu: 0.7
########## Model Parameters ##########
learning rate: 0.0010
context_hops: 2
node_dropout: 1
node_dropout_rate: 0.5
mess_dropout: 1
mess_dropout_rate: 0.1
all_embed: torch.Size([42296, 64])
interact_mat: torch.Size([2625, 2625])
edge_index: torch.Size([2, 332742])
edge_type: torch.Size([332742])
Pretraining RecVAE for 50 epochs (enc 3 / dec 1)...
RecVAE 預訓練完成，已更新 KGCL 的 user embeddings。
Starting KGCL training...
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0000 | CF Time: 25.3s | KG Time: 12.8s | Mean KG Loss: 0.6880

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   0   |   25.3  |   12.8  | [0.18888126] | [0.30748677] | [0.25450689] | [0.85896076] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 0
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0001 | CF Time: 25.6s | KG Time: 14.1s | Mean KG Loss: 0.6826

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   1   |   25.6  |   14.1  | [0.20804751] | [0.3418355] | [0.28197243] | [0.88123012] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 1
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0002 | CF Time: 23.5s | KG Time: 13.3s | Mean KG Loss: 0.6778

+-------+---------+---------+--------------+--------------+--------------+------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   | Hit Ratio  |
+-------+---------+---------+--------------+--------------+--------------+------------+
|   2   |   23.5  |   13.3  | [0.20864062] | [0.34893824] | [0.28525981] | [0.873807] |
+-------+---------+---------+--------------+--------------+--------------+------------+
### Found better model at epoch 2
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0003 | CF Time: 22.9s | KG Time: 12.8s | Mean KG Loss: 0.6723

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   3   |   22.9  |   12.8  | [0.21151645] | [0.35155616] | [0.29109226] | [0.87592789] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 3
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0004 | CF Time: 23.8s | KG Time: 13.1s | Mean KG Loss: 0.6667

+-------+---------+---------+--------------+--------------+--------------+------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   | Hit Ratio  |
+-------+---------+---------+--------------+--------------+--------------+------------+
|   4   |   23.8  |   13.1  | [0.20992677] | [0.35093553] | [0.28822906] | [0.873807] |
+-------+---------+---------+--------------+--------------+--------------+------------+
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0005 | CF Time: 23.4s | KG Time: 13.1s | Mean KG Loss: 0.6604

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   5   |   23.4  |   13.1  | [0.21349136] | [0.35212462] | [0.29172853] | [0.87804878] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 5
Negative sampling time: 0.49s
train_cf_triples shape: (65641, 3)
Epoch 0006 | CF Time: 25.0s | KG Time: 14.9s | Mean KG Loss: 0.6538

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   6   |   25.0  |   14.9  | [0.21118041] | [0.34762747] | [0.28674443] | [0.88229056] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0007 | CF Time: 23.2s | KG Time: 13.0s | Mean KG Loss: 0.6467

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   7   |   23.2  |   13.0  | [0.21180083] | [0.34861234] | [0.28918346] | [0.88123012] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0008 | CF Time: 23.5s | KG Time: 13.4s | Mean KG Loss: 0.6387

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   8   |   23.5  |   13.4  | [0.20887608] | [0.34272799] | [0.28398727] | [0.87592789] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0009 | CF Time: 24.9s | KG Time: 13.3s | Mean KG Loss: 0.6299

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   9   |   24.9  |   13.3  | [0.20366234] | [0.34015025] | [0.28430541] | [0.87486744] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0010 | CF Time: 23.0s | KG Time: 13.0s | Mean KG Loss: 0.6198

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   10  |   23.0  |   13.0  | [0.20377561] | [0.33745781] | [0.28080594] | [0.88229056] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0011 | CF Time: 23.2s | KG Time: 13.0s | Mean KG Loss: 0.6083

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   11  |   23.2  |   13.0  | [0.20371812] | [0.33608969] | [0.28250265] | [0.87592789] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0012 | CF Time: 23.3s | KG Time: 13.0s | Mean KG Loss: 0.5951

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   12  |   23.3  |   13.0  | [0.20258816] | [0.33428667] | [0.27985154] | [0.87062566] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0013 | CF Time: 23.5s | KG Time: 12.9s | Mean KG Loss: 0.5802

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   13  |   23.5  |   12.9  | [0.20194383] | [0.33258332] | [0.27794274] | [0.87274655] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0014 | CF Time: 24.0s | KG Time: 13.0s | Mean KG Loss: 0.5644

+-------+---------+---------+--------------+-------------+--------------+------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   | Hit Ratio  |
+-------+---------+---------+--------------+-------------+--------------+------------+
|   14  |   24.0  |   13.0  | [0.20257067] | [0.3311875] | [0.27995758] | [0.873807] |
+-------+---------+---------+--------------+-------------+--------------+------------+
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0015 | CF Time: 25.1s | KG Time: 14.0s | Mean KG Loss: 0.5460

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   15  |   25.1  |   14.0  | [0.19997896] | [0.32821475] | [0.27560976] | [0.87168611] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Early stopping triggered at epoch 15
Training complete. Early stopping at epoch 15, recall@20: 0.2135
