PID: 8268
Experiment Description: 
########## Model HPs ##########
tau: 0.2
cl_weight: 0.1
mu: 0.7
########## Model Parameters ##########
learning rate: 0.0010
context_hops: 2
node_dropout: 1
node_dropout_rate: 0.5
mess_dropout: 1
mess_dropout_rate: 0.1
all_embed: torch.Size([42296, 64])
interact_mat: torch.Size([2625, 2625])
edge_index: torch.Size([2, 332742])
edge_type: torch.Size([332742])
Pretraining RecVAE for 50 epochs (enc 3 / dec 1)...
RecVAE pretraining complete. Final encoder loss=972.9319, decoder loss=971.6530
Pretraining of RecVAE complete; KGCL user embeddings have been updated.
Starting KGCL training...
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0000 | CF Time: 23.2s | KG Time: 13.3s | Mean KG Loss: 0.6880

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   0   |   23.2  |   13.3  | [0.17221004] | [0.28473618] | [0.23637328] | [0.83563097] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 0
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0001 | CF Time: 23.2s | KG Time: 11.7s | Mean KG Loss: 0.6826

+-------+---------+---------+-------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+-------------+--------------+--------------+--------------+
|   1   |   23.2  |   11.7  | [0.1957626] | [0.32411189] | [0.26680806] | [0.88229056] |
+-------+---------+---------+-------------+--------------+--------------+--------------+
### Found better model at epoch 1
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0002 | CF Time: 23.3s | KG Time: 12.7s | Mean KG Loss: 0.6778

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   2   |   23.3  |   12.7  | [0.20726564] | [0.34754865] | [0.2864263] | [0.88016967] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
### Found better model at epoch 2
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0003 | CF Time: 23.0s | KG Time: 13.0s | Mean KG Loss: 0.6723

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   3   |   23.0  |   13.0  | [0.21582514] | [0.36204917] | [0.29734889] | [0.88123012] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 3
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0004 | CF Time: 23.6s | KG Time: 12.9s | Mean KG Loss: 0.6667

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   4   |   23.6  |   12.9  | [0.22136411] | [0.37083393] | [0.30339343] | [0.89395546] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 4
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0005 | CF Time: 24.0s | KG Time: 12.6s | Mean KG Loss: 0.6604

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   5   |   24.0  |   12.6  | [0.22367323] | [0.37190021] | [0.30487805] | [0.89819724] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 5
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0006 | CF Time: 23.8s | KG Time: 12.8s | Mean KG Loss: 0.6538

+-------+---------+---------+--------------+--------------+--------------+-------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio  |
+-------+---------+---------+--------------+--------------+--------------+-------------+
|   6   |   23.8  |   12.8  | [0.22393461] | [0.37230422] | [0.30487805] | [0.8971368] |
+-------+---------+---------+--------------+--------------+--------------+-------------+
### Found better model at epoch 6
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0007 | CF Time: 23.2s | KG Time: 12.3s | Mean KG Loss: 0.6467

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   7   |   23.2  |   12.3  | [0.22486957] | [0.37180792] | [0.30455992] | [0.90455992] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 7
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0008 | CF Time: 23.1s | KG Time: 12.7s | Mean KG Loss: 0.6388

+-------+---------+---------+--------------+--------------+------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     | Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+------------+--------------+
|   8   |   23.1  |   12.7  | [0.22519395] | [0.36929294] | [0.304772] | [0.89819724] |
+-------+---------+---------+--------------+--------------+------------+--------------+
### Found better model at epoch 8
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0009 | CF Time: 23.3s | KG Time: 12.7s | Mean KG Loss: 0.6301

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   9   |   23.3  |   12.7  | [0.22510702] | [0.37133055] | [0.30593849] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0010 | CF Time: 23.0s | KG Time: 12.7s | Mean KG Loss: 0.6200

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   10  |   23.0  |   12.7  | [0.22589189] | [0.3681306] | [0.30413574] | [0.90668081] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 10
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0011 | CF Time: 23.0s | KG Time: 12.6s | Mean KG Loss: 0.6086

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   11  |   23.0  |   12.6  | [0.22513307] | [0.36615866] | [0.30402969] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0012 | CF Time: 23.0s | KG Time: 12.7s | Mean KG Loss: 0.5955

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   12  |   23.0  |   12.7  | [0.22388136] | [0.36500919] | [0.30180276] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0013 | CF Time: 23.0s | KG Time: 12.6s | Mean KG Loss: 0.5807

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   13  |   23.0  |   12.6  | [0.22312969] | [0.36460701] | [0.30074231] | [0.89183457] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0014 | CF Time: 23.1s | KG Time: 13.5s | Mean KG Loss: 0.5650

+-------+---------+---------+--------------+--------------+-----------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     | Precision |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-----------+--------------+
|   14  |   23.1  |   13.5  | [0.22229766] | [0.36255776] |   [0.3]   | [0.89607635] |
+-------+---------+---------+--------------+--------------+-----------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0015 | CF Time: 23.6s | KG Time: 13.0s | Mean KG Loss: 0.5468

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   15  |   23.6  |   13.0  | [0.22192491] | [0.36172341] | [0.29893955] | [0.90031813] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Early stopping triggered at epoch 15
Training complete. Early stopping at epoch 15, recall@20: 0.2259
