PID: 2352
Experiment Description: 
########## Model HPs ##########
tau: 0.2
cl_weight: 0.1
mu: 0.7
########## Model Parameters ##########
learning rate: 0.0010
context_hops: 2
node_dropout: 1
node_dropout_rate: 0.5
mess_dropout: 1
mess_dropout_rate: 0.1
all_embed: torch.Size([42296, 64])
interact_mat: torch.Size([2625, 2625])
edge_index: torch.Size([2, 332742])
edge_type: torch.Size([332742])
Pretraining RecVAE for 50 epochs (enc 3 / dec 1)...
RecVAE pretraining complete. Final encoder loss=972.9319, decoder loss=971.6530
Pretraining of RecVAE complete; KGCL user embeddings have been updated.
Starting KGCL training...
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0000 | CF Time: 24.7s | KG Time: 12.5s | Mean KG Loss: 0.6880

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   0   |   24.7  |   12.5  | [0.15137899] | [0.25922155] | [0.21505832] | [0.80699894] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 0
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0001 | CF Time: 24.7s | KG Time: 12.0s | Mean KG Loss: 0.6826

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   1   |   24.7  |   12.0  | [0.16951711] | [0.28227372] | [0.23361612] | [0.84835631] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 1
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0002 | CF Time: 24.8s | KG Time: 12.3s | Mean KG Loss: 0.6778

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   2   |   24.8  |   12.3  | [0.18450927] | [0.30491295] | [0.2552492] | [0.86426299] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
### Found better model at epoch 2
Negative sampling time: 0.35s
train_cf_triples shape: (65641, 3)
Epoch 0003 | CF Time: 24.8s | KG Time: 12.9s | Mean KG Loss: 0.6722

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   3   |   24.8  |   12.9  | [0.19780846] | [0.32716548] | [0.27115589] | [0.88123012] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 3
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0004 | CF Time: 24.9s | KG Time: 13.7s | Mean KG Loss: 0.6667

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   4   |   24.9  |   13.7  | [0.20652187] | [0.34091489] | [0.28080594] | [0.88229056] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 4
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0005 | CF Time: 25.0s | KG Time: 12.9s | Mean KG Loss: 0.6603

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   5   |   25.0  |   12.9  | [0.21019371] | [0.35091108] | [0.2864263] | [0.89395546] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
### Found better model at epoch 5
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0006 | CF Time: 25.2s | KG Time: 12.5s | Mean KG Loss: 0.6537

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   6   |   25.2  |   12.5  | [0.21482984] | [0.36110319] | [0.29289502] | [0.89925769] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 6
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0007 | CF Time: 23.6s | KG Time: 12.7s | Mean KG Loss: 0.6466

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   7   |   23.6  |   12.7  | [0.21479222] | [0.36252966] | [0.29459173] | [0.89607635] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0008 | CF Time: 23.2s | KG Time: 12.9s | Mean KG Loss: 0.6386

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   8   |   23.2  |   12.9  | [0.21607445] | [0.36429241] | [0.29512195] | [0.89289502] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 8
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0009 | CF Time: 23.2s | KG Time: 12.7s | Mean KG Loss: 0.6298

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   9   |   23.2  |   12.7  | [0.21767274] | [0.3647154] | [0.29660657] | [0.89819724] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 9
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0010 | CF Time: 24.7s | KG Time: 12.3s | Mean KG Loss: 0.6196

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   10  |   24.7  |   12.3  | [0.21900735] | [0.36792803] | [0.29978791] | [0.89819724] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 10
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0011 | CF Time: 25.2s | KG Time: 12.4s | Mean KG Loss: 0.6080

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   11  |   25.2  |   12.4  | [0.22085918] | [0.37224229] | [0.30148462] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 11
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0012 | CF Time: 25.3s | KG Time: 12.7s | Mean KG Loss: 0.5948

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   12  |   25.3  |   12.7  | [0.22216075] | [0.37248404] | [0.30031813] | [0.90349947] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 12
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0013 | CF Time: 23.4s | KG Time: 12.9s | Mean KG Loss: 0.5798

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   13  |   23.4  |   12.9  | [0.22241448] | [0.37393063] | [0.30307529] | [0.90243902] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 13
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0014 | CF Time: 23.6s | KG Time: 13.0s | Mean KG Loss: 0.5639

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   14  |   23.6  |   13.0  | [0.22245381] | [0.37042046] | [0.30169671] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 14
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0015 | CF Time: 23.2s | KG Time: 12.8s | Mean KG Loss: 0.5455

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   15  |   23.2  |   12.8  | [0.22425902] | [0.37085848] | [0.30275716] | [0.90668081] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 15
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0016 | CF Time: 23.1s | KG Time: 12.6s | Mean KG Loss: 0.5277

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   16  |   23.1  |   12.6  | [0.22483939] | [0.37314494] | [0.30434783] | [0.90562036] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 16
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0017 | CF Time: 23.7s | KG Time: 13.1s | Mean KG Loss: 0.5100

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   17  |   23.7  |   13.1  | [0.22264995] | [0.36957209] | [0.3009544] | [0.90243902] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
Negative sampling time: 0.35s
train_cf_triples shape: (65641, 3)
Epoch 0018 | CF Time: 23.5s | KG Time: 13.0s | Mean KG Loss: 0.4915

+-------+---------+---------+-------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+-------------+--------------+--------------+--------------+
|   18  |   23.5  |   13.0  | [0.2233961] | [0.37125874] | [0.30296925] | [0.90349947] |
+-------+---------+---------+-------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0019 | CF Time: 23.6s | KG Time: 12.9s | Mean KG Loss: 0.4719

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   19  |   23.6  |   12.9  | [0.22514534] | [0.37101892] | [0.30265111] | [0.90668081] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 19
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0020 | CF Time: 23.3s | KG Time: 12.7s | Mean KG Loss: 0.4528

+-------+---------+---------+--------------+--------------+--------------+-------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio  |
+-------+---------+---------+--------------+--------------+--------------+-------------+
|   20  |   23.3  |   12.7  | [0.22607175] | [0.37317657] | [0.30540827] | [0.9088017] |
+-------+---------+---------+--------------+--------------+--------------+-------------+
### Found better model at epoch 20
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0021 | CF Time: 23.2s | KG Time: 12.9s | Mean KG Loss: 0.4353

+-------+---------+---------+-------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+-------------+--------------+--------------+--------------+
|   21  |   23.2  |   12.9  | [0.2243149] | [0.37020048] | [0.30243902] | [0.90562036] |
+-------+---------+---------+-------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0022 | CF Time: 23.0s | KG Time: 12.7s | Mean KG Loss: 0.4179

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   22  |   23.0  |   12.7  | [0.22130779] | [0.36576471] | [0.2990456] | [0.90562036] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0023 | CF Time: 23.7s | KG Time: 12.6s | Mean KG Loss: 0.4021

+-------+---------+---------+-------------+-------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG    |  Precision  |  Hit Ratio   |
+-------+---------+---------+-------------+-------------+-------------+--------------+
|   23  |   23.7  |   12.6  | [0.2212124] | [0.3642602] | [0.2980912] | [0.90668081] |
+-------+---------+---------+-------------+-------------+-------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0024 | CF Time: 23.7s | KG Time: 12.6s | Mean KG Loss: 0.3854

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   24  |   23.7  |   12.6  | [0.21902251] | [0.36261882] | [0.29777306] | [0.90243902] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0025 | CF Time: 23.7s | KG Time: 12.4s | Mean KG Loss: 0.3727

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   25  |   23.7  |   12.4  | [0.21982676] | [0.36251035] | [0.29766702] | [0.89607635] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Early stopping triggered at epoch 25
Training complete. Early stopping at epoch 25, recall@20: 0.2261
