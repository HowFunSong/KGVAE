PID: 20600
Experiment Description: 
########## Model HPs ##########
tau: 0.2
cl_weight: 0.1
mu: 0.7
########## Model Parameters ##########
learning rate: 0.0010
context_hops: 2
node_dropout: 1
node_dropout_rate: 0.5
mess_dropout: 1
mess_dropout_rate: 0.1
all_embed: torch.Size([42296, 64])
interact_mat: torch.Size([2625, 2625])
edge_index: torch.Size([2, 332742])
edge_type: torch.Size([332742])
Pretraining RecVAE for 50 epochs (enc 3 / dec 1)...
RecVAE 預訓練完成，已更新 KGCL 的 user embeddings。
Starting KGCL training...
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0000 | CF Time: 23.0s | KG Time: 13.3s | Mean KG Loss: 0.6880

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   0   |   23.0  |   13.3  | [0.15134121] | [0.25909161] | [0.21484624] | [0.80699894] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 0
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0001 | CF Time: 23.2s | KG Time: 13.5s | Mean KG Loss: 0.6826

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   1   |   23.2  |   13.5  | [0.16966171] | [0.28233431] | [0.23361612] | [0.84835631] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 1
Negative sampling time: 0.43s
train_cf_triples shape: (65641, 3)
Epoch 0002 | CF Time: 23.0s | KG Time: 13.0s | Mean KG Loss: 0.6778

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   2   |   23.0  |   13.0  | [0.18454462] | [0.30497456] | [0.25535525] | [0.86532344] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 2
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0003 | CF Time: 22.9s | KG Time: 12.8s | Mean KG Loss: 0.6723

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   3   |   22.9  |   12.8  | [0.19780846] | [0.32720845] | [0.27115589] | [0.88123012] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 3
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0004 | CF Time: 23.5s | KG Time: 13.0s | Mean KG Loss: 0.6667

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   4   |   23.5  |   13.0  | [0.20631988] | [0.34076951] | [0.28059385] | [0.88229056] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 4
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0005 | CF Time: 23.5s | KG Time: 13.0s | Mean KG Loss: 0.6603

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   5   |   23.5  |   13.0  | [0.20939837] | [0.35055332] | [0.28610817] | [0.89183457] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 5
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0006 | CF Time: 24.2s | KG Time: 14.1s | Mean KG Loss: 0.6538

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   6   |   24.2  |   14.1  | [0.21480333] | [0.36109939] | [0.29278897] | [0.89925769] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 6
Negative sampling time: 0.45s
train_cf_triples shape: (65641, 3)
Epoch 0007 | CF Time: 24.1s | KG Time: 12.9s | Mean KG Loss: 0.6466

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   7   |   24.1  |   12.9  | [0.21450944] | [0.36229171] | [0.29427359] | [0.89607635] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0008 | CF Time: 23.0s | KG Time: 12.9s | Mean KG Loss: 0.6387

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   8   |   23.0  |   12.9  | [0.21625119] | [0.36420221] | [0.29512195] | [0.89289502] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 8
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0009 | CF Time: 24.0s | KG Time: 13.0s | Mean KG Loss: 0.6299

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   9   |   24.0  |   13.0  | [0.21752377] | [0.36469084] | [0.29660657] | [0.89925769] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 9
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0010 | CF Time: 23.3s | KG Time: 13.0s | Mean KG Loss: 0.6198

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   10  |   23.3  |   13.0  | [0.21873877] | [0.36786647] | [0.29946978] | [0.89819724] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 10
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0011 | CF Time: 23.5s | KG Time: 12.1s | Mean KG Loss: 0.6083

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   11  |   23.5  |   12.1  | [0.22082407] | [0.37233213] | [0.30148462] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 11
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0012 | CF Time: 23.4s | KG Time: 13.4s | Mean KG Loss: 0.5951

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   12  |   23.4  |   13.4  | [0.22196145] | [0.3722641] | [0.30010604] | [0.90137858] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 12
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0013 | CF Time: 23.8s | KG Time: 13.0s | Mean KG Loss: 0.5802

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   13  |   23.8  |   13.0  | [0.22205514] | [0.37352004] | [0.30275716] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 13
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0014 | CF Time: 23.3s | KG Time: 12.9s | Mean KG Loss: 0.5645

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   14  |   23.3  |   12.9  | [0.22264627] | [0.37036322] | [0.3019088] | [0.90137858] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
### Found better model at epoch 14
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0015 | CF Time: 23.6s | KG Time: 13.0s | Mean KG Loss: 0.5462

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   15  |   23.6  |   13.0  | [0.22408836] | [0.37034563] | [0.30254507] | [0.90562036] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 15
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0016 | CF Time: 23.1s | KG Time: 12.7s | Mean KG Loss: 0.5285

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   16  |   23.1  |   12.7  | [0.22477996] | [0.37328529] | [0.30455992] | [0.90562036] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 16
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0017 | CF Time: 23.0s | KG Time: 12.6s | Mean KG Loss: 0.5108

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   17  |   23.0  |   12.6  | [0.22259325] | [0.36937932] | [0.30074231] | [0.90243902] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0018 | CF Time: 23.1s | KG Time: 13.1s | Mean KG Loss: 0.4925

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   18  |   23.1  |   13.1  | [0.22335779] | [0.37138732] | [0.30296925] | [0.90349947] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0019 | CF Time: 23.2s | KG Time: 12.9s | Mean KG Loss: 0.4729

+-------+---------+---------+-------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+-------------+--------------+--------------+--------------+
|   19  |   23.2  |   12.9  | [0.2250436] | [0.37083265] | [0.30243902] | [0.90668081] |
+-------+---------+---------+-------------+--------------+--------------+--------------+
### Found better model at epoch 19
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
