PID: 2528
Experiment Description: 
########## Model HPs ##########
tau: 0.2
cl_weight: 0.1
mu: 0.7
########## Model Parameters ##########
learning rate: 0.0010
context_hops: 2
node_dropout: 1
node_dropout_rate: 0.5
mess_dropout: 1
mess_dropout_rate: 0.1
all_embed: torch.Size([42296, 64])
interact_mat: torch.Size([2625, 2625])
edge_index: torch.Size([2, 332742])
edge_type: torch.Size([332742])
Pretraining RecVAE for 50 epochs (enc 3 / dec 1)...
RecVAE 預訓練完成，已更新 KGCL 的 user embeddings。
Starting KGCL training...
Negative sampling time: 0.51s
train_cf_triples shape: (65641, 3)
Epoch 0000 | CF Time: 23.4s | KG Time: 12.8s | Mean KG Loss: 0.6880

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   0   |   23.4  |   12.8  | [0.15139827] | [0.2592968] | [0.21516437] | [0.80699894] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
### Found better model at epoch 0
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0001 | CF Time: 23.9s | KG Time: 14.0s | Mean KG Loss: 0.6826

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   1   |   23.9  |   14.0  | [0.16951711] | [0.28231777] | [0.23361612] | [0.84835631] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 1
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0002 | CF Time: 23.2s | KG Time: 14.2s | Mean KG Loss: 0.6778

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   2   |   23.2  |   14.2  | [0.18440322] | [0.30483251] | [0.25514316] | [0.86426299] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 2
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0003 | CF Time: 23.5s | KG Time: 12.8s | Mean KG Loss: 0.6722

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   3   |   23.5  |   12.8  | [0.19780846] | [0.32718292] | [0.27115589] | [0.88123012] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 3
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0004 | CF Time: 23.5s | KG Time: 13.0s | Mean KG Loss: 0.6667

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   4   |   23.5  |   13.0  | [0.20634513] | [0.34082326] | [0.28069989] | [0.88229056] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 4
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0005 | CF Time: 23.4s | KG Time: 13.4s | Mean KG Loss: 0.6603

+-------+---------+---------+-------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+-------------+--------------+--------------+--------------+
|   5   |   23.4  |   13.4  | [0.2096227] | [0.35057691] | [0.28610817] | [0.89183457] |
+-------+---------+---------+-------------+--------------+--------------+--------------+
### Found better model at epoch 5
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0006 | CF Time: 23.4s | KG Time: 12.8s | Mean KG Loss: 0.6537

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   6   |   23.4  |   12.8  | [0.21480333] | [0.36113956] | [0.29278897] | [0.89925769] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 6
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0007 | CF Time: 23.7s | KG Time: 13.3s | Mean KG Loss: 0.6466

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   7   |   23.7  |   13.3  | [0.21455993] | [0.36227865] | [0.29437964] | [0.89607635] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.34s
train_cf_triples shape: (65641, 3)
Epoch 0008 | CF Time: 22.9s | KG Time: 13.4s | Mean KG Loss: 0.6386

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   8   |   22.9  |   13.4  | [0.21622173] | [0.36415693] | [0.29512195] | [0.89289502] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 8
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0009 | CF Time: 23.0s | KG Time: 13.1s | Mean KG Loss: 0.6298

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   9   |   23.0  |   13.1  | [0.21752377] | [0.36470779] | [0.29660657] | [0.89925769] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 9
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0010 | CF Time: 23.0s | KG Time: 13.2s | Mean KG Loss: 0.6197

+-------+---------+---------+-------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+-------------+--------------+--------------+--------------+
|   10  |   23.0  |   13.2  | [0.2187208] | [0.36767678] | [0.29936373] | [0.89819724] |
+-------+---------+---------+-------------+--------------+--------------+--------------+
### Found better model at epoch 10
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0011 | CF Time: 22.9s | KG Time: 13.1s | Mean KG Loss: 0.6081

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   11  |   22.9  |   13.1  | [0.22075779] | [0.37205421] | [0.30137858] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 11
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0012 | CF Time: 23.2s | KG Time: 13.9s | Mean KG Loss: 0.5949

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   12  |   23.2  |   13.9  | [0.22194572] | [0.37248029] | [0.30031813] | [0.90137858] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 12
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0013 | CF Time: 23.2s | KG Time: 13.3s | Mean KG Loss: 0.5799

+-------+---------+---------+--------------+--------------+-------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision  |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+-------------+--------------+
|   13  |   23.2  |   13.3  | [0.22204487] | [0.37380503] | [0.3028632] | [0.90137858] |
+-------+---------+---------+--------------+--------------+-------------+--------------+
### Found better model at epoch 13
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0014 | CF Time: 23.9s | KG Time: 13.8s | Mean KG Loss: 0.5642

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   14  |   23.9  |   13.8  | [0.22250146] | [0.37037793] | [0.30169671] | [0.90243902] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 14
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0015 | CF Time: 23.2s | KG Time: 13.3s | Mean KG Loss: 0.5458

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   15  |   23.2  |   13.3  | [0.22423338] | [0.37062159] | [0.30275716] | [0.90668081] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 15
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0016 | CF Time: 23.0s | KG Time: 13.4s | Mean KG Loss: 0.5281

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   16  |   23.0  |   13.4  | [0.22488683] | [0.37317475] | [0.30445387] | [0.90562036] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 16
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0017 | CF Time: 23.1s | KG Time: 13.4s | Mean KG Loss: 0.5104

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   17  |   23.1  |   13.4  | [0.22253315] | [0.36955339] | [0.30074231] | [0.90243902] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0018 | CF Time: 23.0s | KG Time: 13.3s | Mean KG Loss: 0.4920

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   18  |   23.0  |   13.3  | [0.22339274] | [0.3713723] | [0.30307529] | [0.90349947] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0019 | CF Time: 23.4s | KG Time: 13.8s | Mean KG Loss: 0.4725

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   19  |   23.4  |   13.8  | [0.22539198] | [0.37115074] | [0.30254507] | [0.90668081] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 19
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0020 | CF Time: 22.9s | KG Time: 13.0s | Mean KG Loss: 0.4536

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   20  |   22.9  |   13.0  | [0.22598277] | [0.37340723] | [0.30572641] | [0.90774125] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
### Found better model at epoch 20
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0021 | CF Time: 22.8s | KG Time: 13.1s | Mean KG Loss: 0.4361

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   21  |   22.8  |   13.1  | [0.22464083] | [0.37014045] | [0.30212089] | [0.90562036] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0022 | CF Time: 22.9s | KG Time: 13.1s | Mean KG Loss: 0.4189

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   22  |   22.9  |   13.1  | [0.22079284] | [0.36575135] | [0.29872747] | [0.90562036] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0023 | CF Time: 22.9s | KG Time: 13.0s | Mean KG Loss: 0.4031

+-------+---------+---------+-------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall   |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+-------------+--------------+--------------+--------------+
|   23  |   22.9  |   13.0  | [0.2211636] | [0.36431617] | [0.29830329] | [0.90668081] |
+-------+---------+---------+-------------+--------------+--------------+--------------+
Negative sampling time: 0.31s
train_cf_triples shape: (65641, 3)
Epoch 0024 | CF Time: 23.5s | KG Time: 12.5s | Mean KG Loss: 0.3866

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   24  |   23.5  |   12.5  | [0.21917356] | [0.36270414] | [0.29777306] | [0.90243902] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.38s
train_cf_triples shape: (65641, 3)
Epoch 0025 | CF Time: 25.7s | KG Time: 13.2s | Mean KG Loss: 0.3739

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   25  |   25.7  |   13.2  | [0.21991778] | [0.36248789] | [0.29766702] | [0.89607635] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0026 | CF Time: 23.6s | KG Time: 13.6s | Mean KG Loss: 0.3596

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   26  |   23.6  |   13.6  | [0.21824508] | [0.35904183] | [0.29469777] | [0.90031813] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0027 | CF Time: 23.1s | KG Time: 13.0s | Mean KG Loss: 0.3460

+-------+---------+---------+--------------+-------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG    |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-------------+--------------+--------------+
|   27  |   23.1  |   13.0  | [0.21738293] | [0.3590068] | [0.29384942] | [0.90031813] |
+-------+---------+---------+--------------+-------------+--------------+--------------+
Negative sampling time: 0.33s
train_cf_triples shape: (65641, 3)
Epoch 0028 | CF Time: 23.3s | KG Time: 13.5s | Mean KG Loss: 0.3343

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   28  |   23.3  |   13.5  | [0.21519902] | [0.35828932] | [0.29141039] | [0.89607635] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0029 | CF Time: 23.5s | KG Time: 13.5s | Mean KG Loss: 0.3243

+-------+---------+---------+--------------+-----------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |    NDCG   |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+-----------+--------------+--------------+
|   29  |   23.5  |   13.5  | [0.21526392] | [0.35243] | [0.29056204] | [0.88759279] |
+-------+---------+---------+--------------+-----------+--------------+--------------+
Negative sampling time: 0.32s
train_cf_triples shape: (65641, 3)
Epoch 0030 | CF Time: 23.9s | KG Time: 14.5s | Mean KG Loss: 0.3128

+-------+---------+---------+--------------+--------------+--------------+--------------+
| Epoch | CF Time | KG Time |    Recall    |     NDCG     |  Precision   |  Hit Ratio   |
+-------+---------+---------+--------------+--------------+--------------+--------------+
|   30  |   23.9  |   14.5  | [0.21399409] | [0.35071813] | [0.29003181] | [0.88971368] |
+-------+---------+---------+--------------+--------------+--------------+--------------+
Early stopping triggered at epoch 30
Training complete. Early stopping at epoch 30, recall@20: 0.2260
